function v(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(t){return typeof t}:v=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function d(e){return S(e)||k(e)||_()}function S(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function k(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function A(e){var t;return typeof e=="function"?t={callback:e}:t=e,t}function I(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,r,l,a=function(o){for(var u=arguments.length,f=new Array(u>1?u-1:0),c=1;c<u;c++)f[c-1]=arguments[c];if(l=f,!(i&&o===r)){var b=n.leading;typeof b=="function"&&(b=b(o,r)),(!i||o!==r)&&b&&e.apply(void 0,[o].concat(d(l))),r=o,clearTimeout(i),i=setTimeout(function(){e.apply(void 0,[o].concat(d(l))),i=0},t)}};return a._clear=function(){clearTimeout(i),i=null},a}function p(e,t){if(e===t)return!0;if(v(e)==="object"){for(var n in e)if(!p(e[n],t[n]))return!1;return!0}return!1}var V=function(){function e(t,n,i){O(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(n,i)}return w(e,[{key:"createObserver",value:function(n,i){var r=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=A(n),this.callback=function(s,o){r.options.callback(s,o),s&&r.options.once&&(r.frozen=!0,r.destroyObserver())},this.callback&&this.options.throttle){var l=this.options.throttleOptions||{},a=l.leading;this.callback=I(this.callback,this.options.throttle,{leading:function(o){return a==="both"||a==="visible"&&o||a==="hidden"&&!o}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(s){var o=s[0];if(s.length>1){var u=s.find(function(c){return c.isIntersecting});u&&(o=u)}if(r.callback){var f=o.isIntersecting&&o.intersectionRatio>=r.threshold;if(f===r.oldResult)return;r.oldResult=f,r.callback(f,o)}},this.options.intersection),i.context.$nextTick(function(){r.observer&&r.observer.observe(r.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),e}();function m(e,t,n){var i=t.value;if(!!i)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var r=new V(e,i,n);e._vue_visibilityState=r}}function T(e,t,n){var i=t.value,r=t.oldValue;if(!p(i,r)){var l=e._vue_visibilityState;if(!i){g(e);return}l?l.createObserver(i,n):m(e,{value:i},n)}}function g(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}var R={bind:m,update:T,unbind:g};function x(e){e.directive("observe-visibility",R)}var z={version:"1.0.0",install:x},h=null;typeof window<"u"?h=window.Vue:typeof global<"u"&&(h=global.Vue);h&&h.use(z);export{R as ObserveVisibility,z as default,x as install};
